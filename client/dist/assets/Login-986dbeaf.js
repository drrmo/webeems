import{g as _,d as O,e as A,f as H,s as Z,T as q,h as B,_ as w,r as d,k as G,l as V,m as Y,n as S,b as n,o as J,p as K,q as Q,t as X,v as ee,w as I,j as se,x as ne,u as te,y as oe,z as re,A as ie,L as ae,F as le,C as ce,c as ue,i as de}from"./index-a50eb7ee.js";import{A as me}from"./Alert-5e12cda2.js";import{T as $}from"./TextField-4f6a2b48.js";import{B as fe}from"./Select-c8b83df3.js";import"./useFormControl-323236cf.js";import"./useId-519d9372.js";import"./useControlled-20eeda9a.js";function pe(e){return O("MuiLink",e)}const ge=_("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),xe=ge,D={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},he=e=>D[e]||e,ye=({theme:e,ownerState:s})=>{const t=he(s.color),r=A(e,`palette.${t}`,!1)||s.color,c=A(e,`palette.${t}Channel`);return"vars"in e&&c?`rgba(${c} / 0.4)`:H(r,.4)},be=ye,Ee=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],we=e=>{const{classes:s,component:t,focusVisible:r,underline:c}=e,l={root:["root",`underline${B(c)}`,t==="button"&&"button",r&&"focusVisible"]};return K(l,pe,s)},ve=Z(q,{name:"MuiLink",slot:"Root",overridesResolver:(e,s)=>{const{ownerState:t}=e;return[s.root,s[`underline${B(t.underline)}`],t.component==="button"&&s.button]}})(({theme:e,ownerState:s})=>w({},s.underline==="none"&&{textDecoration:"none"},s.underline==="hover"&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},s.underline==="always"&&w({textDecoration:"underline"},s.color!=="inherit"&&{textDecorationColor:be({theme:e,ownerState:s})},{"&:hover":{textDecorationColor:"inherit"}}),s.component==="button"&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${xe.focusVisible}`]:{outline:"auto"}})),je=d.forwardRef(function(s,t){const r=G({props:s,name:"MuiLink"}),{className:c,color:l="primary",component:m="a",onBlur:u,onFocus:f,TypographyClasses:p,underline:g="always",variant:o="inherit",sx:i}=r,x=V(r,Ee),{isFocusVisibleRef:b,onBlur:R,onFocus:j,ref:L}=Y(),[F,T]=d.useState(!1),v=S(t,L),P=E=>{R(E),b.current===!1&&T(!1),u&&u(E)},y=E=>{j(E),b.current===!0&&T(!0),f&&f(E)},k=w({},r,{color:l,component:m,focusVisible:F,underline:g,variant:o}),N=we(k);return n.jsx(ve,w({color:l,className:J(N.root,c),classes:p,component:m,onBlur:P,onFocus:y,ref:v,ownerState:k,variant:o,sx:[...Object.keys(D).includes(l)?[]:[{color:l}],...Array.isArray(i)?i:[i]]},x))}),Le=je,Ce=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],Te={entering:{transform:"none"},entered:{transform:"none"}},ke=d.forwardRef(function(s,t){const r=Q(),c={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:l,appear:m=!0,children:u,easing:f,in:p,onEnter:g,onEntered:o,onEntering:i,onExit:x,onExited:b,onExiting:R,style:j,timeout:L=c,TransitionComponent:F=X}=s,T=V(s,Ce),v=d.useRef(null),P=S(v,u.ref,t),y=a=>h=>{if(a){const C=v.current;h===void 0?a(C):a(C,h)}},k=y(i),N=y((a,h)=>{ee(a);const C=I({style:j,timeout:L,easing:f},{mode:"enter"});a.style.webkitTransition=r.transitions.create("transform",C),a.style.transition=r.transitions.create("transform",C),g&&g(a,h)}),E=y(o),M=y(R),W=y(a=>{const h=I({style:j,timeout:L,easing:f},{mode:"exit"});a.style.webkitTransition=r.transitions.create("transform",h),a.style.transition=r.transitions.create("transform",h),x&&x(a)}),z=y(b),U=a=>{l&&l(v.current,a)};return n.jsx(F,w({appear:m,in:p,nodeRef:v,onEnter:N,onEntered:E,onEntering:k,onExit:W,onExited:z,onExiting:M,addEndListener:U,timeout:L},T,{children:(a,h)=>d.cloneElement(u,w({style:w({transform:"scale(0)",visibility:a==="exited"&&!p?"hidden":void 0},Te[a],j,u.props.style),ref:P},h))}))}),Re=ke,Fe="/assets/login-bg-bebc8f63.mp4",Pe="/assets/webeems-ade45d76.svg";async function We(){return window.document.title="Login | WebEEMS",se({})}async function ze({request:e}){var c,l,m,u,f,p,g,o;const s=await e.formData(),{username:t,password:r}=Object.fromEntries(s);try{const{success:i,error:x}=await ne(t,r);return{success:i,error:x}}catch(i){return{error:{message:(c=i.response)!=null&&c.status||((l=i.error)==null?void 0:l.status)===404?"Server is offline. Please try again later.":(m=i.response)!=null&&m.status||((u=i.error)==null?void 0:u.status)===401?"Unauthorized Access":(f=i.response)!=null&&f.status||((p=i.error)==null?void 0:p.status)===403?((g=i.response)==null?void 0:g.message)||((o=i.error)==null?void 0:o.message):"Unable to establish an internet connection.Please check your connection and try again."}}}}function Ne(){const e=te(),s=oe(),t=re(),[r,c]=d.useState(!0),[l,m]=d.useState({show:!1,message:"Invalid Email and Password!"}),[u,f]=d.useState(!1);d.useEffect(()=>{const o=e.loginInfo;o&&o.expiresIn>Date.now()&&p(o.id,o.role),c(!1),setTimeout(()=>f(!0),500)},[]),d.useEffect(()=>{t!=null&&t.error?m(o=>({...o,message:t.error.message,show:!0})):t!=null&&t.success&&(e==null||e.setLoginInfo(t.success),setTimeout(()=>f(!1),10),setTimeout(()=>{m(o=>({...o,show:!1})),setTimeout(()=>c(!0),10)},50))},[t,e,e.resetLoginInfo,e.setLoginInfo]);const p=d.useCallback((o,i)=>{const x=()=>{e.resetLoginInfo(),window.location.replace(`${window.location.origin}`)};ie(o,i).then(b=>{b.data.success?window.location.replace(`${window.location.origin}`):b.data.error&&x()}).catch(()=>x())},[e]),g=d.useCallback(()=>m(o=>({...o,show:!1})),[]);return n.jsxs(n.Fragment,{children:[s.state==="submitting"||r||!u?n.jsx(ae,{}):void 0,u?n.jsxs("div",{className:"container-fluid overflow-auto vw-100 vh-100 bg-gradient-webeems d-flex align-items-center justify-content-center",children:[n.jsxs("video",{className:"position-absolute start-0 top-0 w-100 h-100 object-fit-cover opacity-50",style:{zIndex:"0"},autoPlay:!0,loop:!0,muted:!0,playsInline:!0,children:[n.jsx("source",{src:Fe,type:"video/mp4"}),n.jsx("p",{children:"Your Browser does not support video format"})]}),s.state==="idle"?n.jsx(Re,{in:!!l.show,unmountOnExit:!0,timeout:500,sx:{position:"fixed",top:"1%",right:"1%"},children:n.jsx(me,{onClose:g,severity:"error",children:l.message})}):void 0,n.jsxs("div",{className:"container z-1",children:[n.jsxs("div",{className:"row justify-content-center",children:[n.jsx("img",{className:"col-auto flex-grow-1 col-sm-6",src:Pe,alt:"WebEEMS"}),n.jsx("div",{className:"card text-center w-100 col-12 col-sm-6 shadow bg-webeems-gradient",style:{maxWidth:"450px",borderRadius:"20px"},children:n.jsx("div",{className:"card-body d-flex flex-column align-items-center py-5 px-4",children:n.jsxs(le,{method:"post",noValidate:!0,children:[n.jsx("div",{className:"h2 text-light-emphasis",children:"Login"}),n.jsx($,{margin:"normal",fullWidth:!0,id:"username",label:"Username",name:"username",autoComplete:"username",autoFocus:!0,style:{backgroundColor:"rgba(255,255,255,0.5)"}}),n.jsx($,{margin:"normal",fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",style:{backgroundColor:"rgba(255,255,255,0.5)"}}),n.jsx(fe,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:2,mb:2},children:"Log In"}),n.jsx(Le,{href:"#",variant:"body2",children:"Forgot password?"})]})})})]}),n.jsx(ce,{className:"mt-5"})]})]}):void 0]})}Ne.displayName="LoginPageRoute";function Ae(){const e=ue();return de(e)?n.jsxs("h1",{children:[e.status," ",e.statusText]}):n.jsx("h1",{children:e.message||e})}Ae.displayName="LoginPageErrorBoundary";export{Ne as Component,Ae as ErrorBoundary,ze as action,We as loader};
